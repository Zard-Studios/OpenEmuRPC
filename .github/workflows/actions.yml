name: 'Build OpenEmuRPC'
on:
  release:
    types: [published]

jobs:
  build:
    name: 'Build OpenEmuRPC'
    runs-on: ${{ matrix.os }}
    strategy:
      fail-fast: false
      matrix:
        include:
          - os: macos-13
            arch: x86_64
          - os: macos-14
            arch: arm64
    steps:
    - uses: actions/checkout@v3
    - uses: actions/setup-python@v3
      with:
        python-version: 3.12

    - name: "Build"
      run: |
        cd scripts &&
        ./build.sh &&
        cd ../dist &&
        zip -yr OpenEmuRPC-${{ matrix.arch }}.zip OpenEmuRPC.app/

    - name: "Upload Build"
      uses: softprops/action-gh-release@v0.1.15
      with:
        files: dist/OpenEmuRPC-${{ matrix.arch }}.zip
